!function(c){"use strict";var v=c.plot.uiConstants.ZOOM_DISTANCE_MARGIN;function t(u,e){var n,i,a,d,p={zoomEnable:!1,prevDistance:null,prevTapTime:0,prevPanPosition:{x:0,y:0},prevTapPosition:{x:0,y:0}},h={prevTouchedAxis:"none",currentTouchedAxis:"none",touchedAxis:null,navigationConstraint:"unconstrained",initialState:null},o=e.pan.interactive&&"manual"===e.pan.touchMode,r="smartLock"===e.pan.touchMode,s=e.pan.interactive&&(r||"smart"===e.pan.touchMode);function l(e){var t,n;h.touchedAxis=(t=u,n=h,"pinchstart"!==(e=e).type?"panstart"===e.type||"pinchend"===e.type?t.getTouchedAxis(e.detail.touches[0].pageX,e.detail.touches[0].pageY):n.touchedAxis:(n=t.getTouchedAxis(e.detail.touches[0].pageX,e.detail.touches[0].pageY),t=t.getTouchedAxis(e.detail.touches[1].pageX,e.detail.touches[1].pageY),n.length===t.length&&n.toString()===t.toString()?n:void 0)),x(h)?h.navigationConstraint="unconstrained":h.navigationConstraint="axisConstrained"}n={start:function(e){l(e),g(e,"pan",p,h),s&&(e=f(e,"pan"),h.initialState=u.navigationState(e.x,e.y))},drag:function(e){var t;l(e),s?(t=f(e,"pan"),u.smartPan({x:h.initialState.startPageX-t.x,y:h.initialState.startPageY-t.y},h.initialState,h.touchedAxis,!1,r)):o&&(u.pan({left:-P(e,"pan",p).x,top:-P(e,"pan",p).y,axes:h.touchedAxis}),A(e,"pan",p,h))},end:function(e){var t;l(e),s&&u.smartPan.end(),t=e,p.zoomEnable&&1===t.detail.touches.length&&updateprevPanPosition(e,"pan",p,h)}},i={start:function(e){d&&(clearTimeout(d),d=null),l(e),p.prevDistance=T(e),g(e,"pinch",p,h)},drag:function(c){d=d||setTimeout(function(){l(c),u.pan({left:-P(c,"pinch",p).x,top:-P(c,"pinch",p).y,axes:h.touchedAxis}),A(c,"pinch",p,h);var e,t,n,i,a,o,r,s=T(c);(p.zoomEnable||Math.abs(s-p.prevDistance)>v)&&(s=c,t=p,n=h,i=(e=u).offset(),a={left:0,top:0},o=T(s)/t.prevDistance,r=T(s),a.left=f(s,"pinch").x-i.left,a.top=f(s,"pinch").y-i.top,e.zoom({center:a,amount:o,axes:n.touchedAxis}),t.prevDistance=r,p.zoomEnable=!0),d=null},1e3/60)},end:function(e){d&&(clearTimeout(d),d=null),l(e),p.prevDistance=null}},a={recenterPlot:function(e){var t,n,i,a,o,r;e&&e.detail&&"touchstart"===e.detail.type&&(t=o=u,n=e=e,i=r=h,void 0!==(a=t.getTouchedAxis(n.detail.firstTouch.x,n.detail.firstTouch.y))[0]&&(i.prevTouchedAxis=a[0].direction),void 0!==(a=t.getTouchedAxis(n.detail.secondTouch.x,n.detail.secondTouch.y))[0]&&(i.touchedAxis=a,i.currentTouchedAxis=a[0].direction),x(i)&&(i.touchedAxis=null,i.prevTouchedAxis="none",i.currentTouchedAxis="none"),"x"===r.currentTouchedAxis&&"x"===r.prevTouchedAxis||"y"===r.currentTouchedAxis&&"y"===r.prevTouchedAxis||"none"===r.currentTouchedAxis&&"none"===r.prevTouchedAxis)&&(o.recenter({axes:r.touchedAxis}),r=r.touchedAxis?new c.Event("re-center",{detail:{axisTouched:r.touchedAxis}}):new c.Event("re-center",{detail:e}),o.getPlaceholder().trigger(r))}},!0!==e.pan.enableTouch&&!0!==e.zoom.enableTouch||(u.hooks.bindEvents.push(function(e,t){(e=e.getOptions()).zoom.interactive&&e.zoom.enableTouch&&(t[0].addEventListener("pinchstart",i.start,!1),t[0].addEventListener("pinchdrag",i.drag,!1),t[0].addEventListener("pinchend",i.end,!1)),e.pan.interactive&&e.pan.enableTouch&&(t[0].addEventListener("panstart",n.start,!1),t[0].addEventListener("pandrag",n.drag,!1),t[0].addEventListener("panend",n.end,!1)),e.recenter.interactive&&e.recenter.enableTouch&&t[0].addEventListener("doubletap",a.recenterPlot,!1)}),u.hooks.shutdown.push(function(e,t){t[0].removeEventListener("panstart",n.start),t[0].removeEventListener("pandrag",n.drag),t[0].removeEventListener("panend",n.end),t[0].removeEventListener("pinchstart",i.start),t[0].removeEventListener("pinchdrag",i.drag),t[0].removeEventListener("pinchend",i.end),t[0].removeEventListener("doubletap",a.recenterPlot)}))}function x(e){return!e.touchedAxis||0===e.touchedAxis.length}function g(e,t,n,i){var a,o=f(e,t);switch(i.navigationConstraint){case"unconstrained":i.touchedAxis=null,n.prevTapPosition={x:n.prevPanPosition.x,y:n.prevPanPosition.y},n.prevPanPosition={x:o.x,y:o.y};break;case"axisConstrained":a=i.touchedAxis[0].direction,i.currentTouchedAxis=a,n.prevTapPosition[a]=n.prevPanPosition[a],n.prevPanPosition[a]=o[a]}}function T(e){var t,n,i=e.detail.touches[0],e=e.detail.touches[1];return t=i.pageX,i=i.pageY,n=e.pageX,e=e.pageY,Math.sqrt((t-n)*(t-n)+(i-e)*(i-e))}function A(e,t,n,i){var a=f(e,t);switch(i.navigationConstraint){case"unconstrained":n.prevPanPosition.x=a.x,n.prevPanPosition.y=a.y;break;case"axisConstrained":n.prevPanPosition[i.currentTouchedAxis]=a[i.currentTouchedAxis]}}function P(e,t,n){e=f(e,t);return{x:e.x-n.prevPanPosition.x,y:e.y-n.prevPanPosition.y}}function f(e,t){return"pinch"===t?{x:(e.detail.touches[0].pageX+e.detail.touches[1].pageX)/2,y:(e.detail.touches[0].pageY+e.detail.touches[1].pageY)/2}:{x:e.detail.touches[0].pageX,y:e.detail.touches[0].pageY}}c.plot.plugins.push({init:function(e){e.hooks.processOptions.push(t)},options:{zoom:{enableTouch:!1},pan:{enableTouch:!1,touchMode:"manual"},recenter:{enableTouch:!0}},name:"navigateTouch",version:"0.3"})}(jQuery);