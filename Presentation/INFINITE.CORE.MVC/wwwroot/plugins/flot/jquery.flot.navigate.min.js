!function(Y){"use strict";var O=Y.plot.saturated,X=Y.plot.browser,T=Y.plot.uiConstants.SNAPPING_CONSTANT,z=Y.plot.uiConstants.PANHINT_LENGTH_CONSTANT;function e(m,t){var r=null,a=!1,n="manual"===t.pan.mode,o="smartLock"===t.pan.mode,i=o||"smart"===t.pan.mode;var s,f="default",h=null,l=null,c={x:0,y:0},p=!1;function u(t,e){var o,a,n=Math.abs(t.originalEvent.deltaY)<=1?1+Math.abs(t.originalEvent.deltaY)/50:null;if(p&&b(t),m.getOptions().zoom.active)return t.preventDefault(),t=t,e=e<0,n=n,t=X.getPageXY(t),(o=m.offset()).left=t.X-o.left,o.top=t.Y-o.top,(a=m.getPlaceholder().offset()).left=t.X-a.left,a.top=t.Y-a.top,0===(t=m.getXAxes().concat(m.getYAxes()).filter(function(t){t=t.box;if(void 0!==t)return a.left>t.left&&a.left<t.left+t.width&&a.top>t.top&&a.top<t.top+t.height})).length&&(t=void 0),e?m.zoomOut({center:o,axes:t,amount:n}):m.zoom({center:o,axes:t,amount:n}),!1}function d(t){a=!0}function g(t){a=!1}function x(t){if(!a||0!==t.button)return!1;p=!0;var t=X.getPageXY(t),e=m.getPlaceholder().offset(),o=(e.left=t.X-e.left,e.top=t.Y-e.top,0===(r=m.getXAxes().concat(m.getYAxes()).filter(function(t){t=t.box;if(void 0!==t)return e.left>t.left&&e.left<t.left+t.width&&e.top>t.top&&e.top<t.top+t.height})).length&&(r=void 0),m.getPlaceholder().css("cursor"));o&&(f=o),m.getPlaceholder().css("cursor",m.getOptions().pan.cursor),i?s=m.navigationState(t.X,t.Y):n&&(c.x=t.X,c.y=t.Y)}function v(t){var e;p&&(e=X.getPageXY(t),-1===(t=m.getOptions().pan.frameRate)?i?m.smartPan({x:s.startPageX-e.X,y:s.startPageY-e.Y},s,r,!1,o):n&&(m.pan({left:c.x-e.X,top:c.y-e.Y,axes:r}),c.x=e.X,c.y=e.Y):!l&&t&&(l=setTimeout(function(){i?m.smartPan({x:s.startPageX-e.X,y:s.startPageY-e.Y},s,r,!1,o):n&&(m.pan({left:c.x-e.X,top:c.y-e.Y,axes:r}),c.x=e.X,c.y=e.Y),l=null},1/t*1e3)))}function b(t){p&&(l&&(clearTimeout(l),l=null),p=!1,t=X.getPageXY(t),m.getPlaceholder().css("cursor",f),i?(m.smartPan({x:s.startPageX-t.X,y:s.startPageY-t.Y},s,r,!1,o),m.smartPan.end()):n&&(m.pan({left:c.x-t.X,top:c.y-t.Y,axes:r}),c.x=0,c.y=0))}function y(t){var e;m.activate(),m.getOptions().recenter.interactive&&(e=m.getTouchedAxis(t.clientX,t.clientY),m.recenter({axes:e[0]?e:null}),e=e[0]?new Y.Event("re-center",{detail:{axisTouched:e[0]}}):new Y.Event("re-center",{detail:t}),m.getPlaceholder().trigger(e))}function P(t){return m.activate(),p&&b(t),!1}m.navigationState=function(t,e){var o=this.getAxes(),a={};return Object.keys(o).forEach(function(t){var e=o[t];a[t]={navigationOffset:{below:e.options.offset.below||0,above:e.options.offset.above||0},axisMin:e.min,axisMax:e.max,diagMode:!1}}),a.startPageX=t||0,a.startPageY=e||0,a},m.activate=function(){var t=m.getOptions();t.pan.active&&t.zoom.active||(t.pan.active=!0,t.zoom.active=!0,m.getPlaceholder().trigger("plotactivated",[m]))},m.zoomOut=function(t){(t=t||{}).amount||(t.amount=m.getOptions().zoom.amount),t.amount=1/t.amount,m.zoom(t)},m.zoom=function(t){var e,o=(t=t||{}).center,a=t.amount||m.getOptions().zoom.amount,n=m.width(),i=m.height(),s=t.axes||m.getAxes(),r=(o=o||{left:n/2,top:i/2}).left/n,f=o.top/i,l={x:{min:o.left-r*n/a,max:o.left+(1-r)*n/a},y:{min:o.top-f*i/a,max:o.top+(1-f)*i/a}};for(e in s)if(s.hasOwnProperty(e)){var c=s[e],p=c.options,u=l[c.direction].min,d=l[c.direction].max,g=c.options.offset;if((p.axisZoom||!t.axes)&&(t.axes||p.plotZoom)){if(u=Y.plot.saturated.saturate(c.c2p(u)),(d=Y.plot.saturated.saturate(c.c2p(d)))<u&&(x=u,u=d,d=x),p.zoomRange){if(d-u<p.zoomRange[0])continue;if(d-u>p.zoomRange[1])continue}var x=Y.plot.saturated.saturate(g.below-(c.min-u)),u=Y.plot.saturated.saturate(g.above-(c.max-d));p.offset={below:x,above:u}}}m.setupGrid(!0),m.draw(),t.preventEvent||m.getPlaceholder().trigger("plotzoom",[m,t])},m.pan=function(s){var r={x:+s.left,y:+s.top};isNaN(r.x)&&(r.x=0),isNaN(r.y)&&(r.y=0),Y.each(s.axes||m.getAxes(),function(t,e){var o,a,n=e.options,i=r[e.direction];!n.axisPan&&s.axes||!n.plotPan&&!s.axes||(a=e.p2c(n.panRange[0])-e.p2c(e.min),o=e.p2c(n.panRange[1])-e.p2c(e.max),void 0!==n.panRange[0]&&o<=i&&(i=o),0!==(i=void 0!==n.panRange[1]&&i<=a?a:i)&&(o=O.saturate(e.c2p(e.p2c(e.min)+i)-e.c2p(e.p2c(e.min))),a=O.saturate(e.c2p(e.p2c(e.max)+i)-e.c2p(e.p2c(e.max))),isFinite(o)||(o=0),isFinite(a)||(a=0),n.offset={below:O.saturate(o+(n.offset.below||0)),above:O.saturate(a+(n.offset.above||0))}))}),m.setupGrid(!0),m.draw(),s.preventEvent||m.getPlaceholder().trigger("plotpan",[m,s])},m.recenter=function(o){Y.each(o.axes||m.getAxes(),function(t,e){o.axes?"x"===this.direction?e.options.offset={below:0}:"y"===this.direction&&(e.options.offset={above:0}):e.options.offset={below:0,above:0}}),m.setupGrid(!0),m.draw()};var w=null,M={x:0,y:0};m.smartPan=function(o,t,a,e,n){var i,s,r,f,l,c,p,u,d,g,x=!!n||(x=o,Math.abs(x.y)<T&&Math.abs(x.x)>=T)||Math.abs(x.x)<T&&Math.abs(x.y)>=T,v=m.getAxes();o=n?function(t){switch(w=!w&&Math.max(Math.abs(t.x),Math.abs(t.y))>=T?Math.abs(t.x)<Math.abs(t.y)?"y":"x":w){case"x":return{x:t.x,y:0};case"y":return{x:0,y:t.y};default:return{x:0,y:0}}}(o):(n=o,Math.abs(n.x)<T&&Math.abs(n.y)>=T?{x:0,y:n.y}:Math.abs(n.y)<T&&Math.abs(n.x)>=T?{x:n.x,y:0}:n),n=o,0<Math.abs(n.x)&&0<Math.abs(n.y)&&(t.diagMode=!0),x&&!0===t.diagMode&&(t.diagMode=!1,s=v,r=t,f=o,Object.keys(s).forEach(function(t){l=s[t],0===f[l.direction]&&(l.options.offset.below=r[t].navigationOffset.below,l.options.offset.above=r[t].navigationOffset.above)})),h=x?{start:{x:t.startPageX-m.offset().left+m.getPlotOffset().left,y:t.startPageY-m.offset().top+m.getPlotOffset().top},end:{x:t.startPageX-o.x-m.offset().left+m.getPlotOffset().left,y:t.startPageY-o.y-m.offset().top+m.getPlotOffset().top}}:{start:{x:t.startPageX-m.offset().left+m.getPlotOffset().left,y:t.startPageY-m.offset().top+m.getPlotOffset().top},end:!1},isNaN(o.x)&&(o.x=0),isNaN(o.y)&&(o.y=0),a&&(v=a),Object.keys(v).forEach(function(t){var e;c=v[t],p=c.min,u=c.max,i=c.options,g=o[c.direction],d=M[c.direction],!i.axisPan&&a||!a&&!i.plotPan||(t=d+c.p2c(i.panRange[0])-c.p2c(p),e=d+c.p2c(i.panRange[1])-c.p2c(u),void 0!==i.panRange[0]&&e<=g&&(g=e),0!==(g=void 0!==i.panRange[1]&&g<=t?t:g)&&(e=O.saturate(c.c2p(c.p2c(p)-(d-g))-c.c2p(c.p2c(p))),t=O.saturate(c.c2p(c.p2c(u)-(d-g))-c.c2p(c.p2c(u))),isFinite(e)||(e=0),isFinite(t)||(t=0),c.options.offset.below=O.saturate(e+(c.options.offset.below||0)),c.options.offset.above=O.saturate(t+(c.options.offset.above||0))))}),M=o,m.setupGrid(!0),m.draw(),e||m.getPlaceholder().trigger("plotpan",[m,o,a,t])},m.smartPan.end=function(){w=h=null,M={x:0,y:0},m.triggerRedrawOverlay()},m.getTouchedAxis=function(t,e){var o=m.getPlaceholder().offset();return o.left=t-o.left,o.top=e-o.top,m.getXAxes().concat(m.getYAxes()).filter(function(t){t=t.box;if(void 0!==t)return o.left>t.left&&o.left<t.left+t.width&&o.top>t.top&&o.top<t.top+t.height})},m.hooks.drawOverlay.push(function(t,e){var o,a,n,i,s;h&&(e.strokeStyle="rgba(96, 160, 208, 0.7)",e.lineWidth=2,e.lineJoin="round",o=Math.round(h.start.x),a=Math.round(h.start.y),r?"x"===r[0].direction?(i=Math.round(h.start.y),n=Math.round(h.end.x)):"y"===r[0].direction&&(n=Math.round(h.start.x),i=Math.round(h.end.y)):(n=Math.round(h.end.x),i=Math.round(h.end.y)),e.beginPath(),!1===h.end?(e.moveTo(o,a-z),e.lineTo(o,a+z),e.moveTo(o+z,a),e.lineTo(o-z,a)):(e.moveTo(o-((s=a===i)?0:z),a-(s?z:0)),e.lineTo(o+(s?0:z),a+(s?z:0)),e.moveTo(o,a),e.lineTo(n,i),e.moveTo(n-(s?0:z),i-(s?z:0)),e.lineTo(n+(s?0:z),i+(s?z:0))),e.stroke())}),m.hooks.bindEvents.push(function(t,e){var o=t.getOptions();o.zoom.interactive&&e.mousewheel(u),o.pan.interactive&&(t.addEventHandler("dragstart",x,e,0),t.addEventHandler("drag",v,e,0),t.addEventHandler("dragend",b,e,0),e.bind("mousedown",d),e.bind("mouseup",g)),e.dblclick(y),e.click(P)}),m.hooks.shutdown.push(function(t,e){e.unbind("mousewheel",u),e.unbind("mousedown",d),e.unbind("mouseup",g),e.unbind("dragstart",x),e.unbind("drag",v),e.unbind("dragend",b),e.unbind("dblclick",y),e.unbind("click",P),l&&clearTimeout(l)})}Y.plot.plugins.push({init:function(t){t.hooks.processOptions.push(e)},options:{zoom:{interactive:!1,active:!1,amount:1.5},pan:{interactive:!1,active:!1,cursor:"move",frameRate:60,mode:"smart"},recenter:{interactive:!0},xaxis:{axisZoom:!0,plotZoom:!0,axisPan:!0,plotPan:!0,panRange:[void 0,void 0],zoomRange:[void 0,void 0]},yaxis:{axisZoom:!0,plotZoom:!0,axisPan:!0,plotPan:!0,panRange:[void 0,void 0],zoomRange:[void 0,void 0]}},name:"navigate",version:"1.3"})}(jQuery);